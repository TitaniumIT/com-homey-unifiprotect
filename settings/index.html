<!doctype html>
<html>

<head>
    <script type="text/javascript" src="/homey.js" data-origin="settings"></script>
</head>

<body>
    <h1 data-i18n="settings.title"></h1>

    <fieldset>
        <legend data-i18n="settings.title"></legend>

        <div class="field row">
            <label for="ufv_apikey" data-i18n="settings.apikey"></label>
            <input id="ufv_apikey" type="text" value="" />
        </div>

        <button id="apply" class="right" data-i18n="settings.apply"></button>
    </fieldset>

    <script type="text/javascript">

        function onHomeyReady(Homey) {
            Homey.ready();

            var apiKeyElement = document.getElementById('ufv_apikey');
            var saveElement = document.getElementById('apply');

            Homey.get('ufv_apikey', function (err, apiKey) {
                if (err) {
                    return Homey.alert(err);
                }
                apiKeyElement.value = apiKey;
            });

            saveElement.addEventListener('click', function (e) {
                Homey.set('ufv_apikey', apiKeyElement.value, function (err) {
                    if (err) {
                        return Homey.alert(err);
                    }
                });
            });
        }
    </script>
</body>

</html>